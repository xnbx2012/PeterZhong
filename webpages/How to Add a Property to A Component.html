<!DOCTYPE html>
<!-- saved from url=(0083)https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>How to Add a Property to A Component</title><link rel="shortcut icon" href="https://ssl.gstatic.com/docs/documents/images/kix-favicon6.ico"><link rel="icon" href="icon.png" type="image/x-icon" /><style type="text/css" nonce="">
      body {
        font-family: arial, sans, sans-serif;
        margin: 0;
      }

      iframe {
        border: 0;
        frameborder: 0;
        height: 100%;
        width: 100%;
      }

      #header, #footer {
        background: #f0f0f0;
        padding: 10px 10px;
      }

      #header {
        border-bottom: 1px #ccc solid;
      }

      #footer {
        border-top: 1px #ccc solid;
        border-bottom: 1px #ccc solid;
        font-size: 13;
      }

      #contents {
        margin: 6px;
      }

      .dash {
        padding: 0 6px;
      }
    </style></head><body><div id="header">How to Add a Property to A Component</div><div id="contents"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c4{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:141.8pt;border-top-color:#000000;border-bottom-style:solid}.c14{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:106.5pt;border-top-color:#000000;border-bottom-style:solid}.c35{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:170.2pt;border-top-color:#000000;border-bottom-style:solid}.c34{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:156pt;border-top-color:#000000;border-bottom-style:solid}.c29{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:192pt;border-top-color:#000000;border-bottom-style:solid}.c8{-webkit-text-decoration-skip:none;color:#1155cc;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:11pt;font-family:"Arial";font-style:normal}.c9{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c30{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:italic}.c0{color:#38761d;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Courier New";font-style:normal}.c47{-webkit-text-decoration-skip:none;text-decoration:line-through;vertical-align:baseline;text-decoration-skip-ink:none;font-style:normal}.c31{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:center;height:11pt}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left;height:11pt}.c40{padding-top:14pt;padding-bottom:4pt;line-height:1.15;text-align:left}.c21{padding-top:18pt;padding-bottom:4pt;line-height:1.15;text-align:left}.c32{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:center}.c37{padding-top:0pt;padding-bottom:0pt;line-height:1.38;text-align:left}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c25{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c11{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c23{padding-top:12pt;padding-bottom:2pt;line-height:1.15;text-align:left}.c13{font-size:9pt;font-family:"Courier New";color:#a64d79;font-weight:700}.c2{font-size:9pt;font-family:"Courier New";color:#741b47;font-weight:700}.c33{border-spacing:0;border-collapse:collapse;margin-right:auto}.c36{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c17{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:center}.c1{font-size:9pt;font-family:"Courier New";font-weight:400}.c43{font-weight:700;font-size:11pt;font-family:"Arial"}.c15{text-decoration:none;vertical-align:baseline;font-style:normal}.c24{font-weight:700;font-size:14pt;font-family:"Arial"}.c38{font-weight:700;font-size:12pt;font-family:"Arial"}.c19{margin-left:36pt;orphans:2;widows:2}.c10{margin-left:54pt;orphans:2;widows:2}.c16{font-weight:400;font-size:11pt;font-family:"Arial"}.c27{font-weight:400;font-size:11pt;font-family:"Courier New"}.c20{orphans:2;widows:2}.c49{font-weight:400;font-size:9pt}.c42{font-weight:400;font-family:"Courier New"}.c44{font-size:24pt;font-weight:700}.c45{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c7{color:inherit;text-decoration:inherit}.c26{color:#38761d}.c52{font-weight:700}.c6{color:#0000ff}.c18{height:0pt}.c22{font-size:10pt}.c50{font-size:8pt}.c41{color:#6aa84f}.c48{font-family:"Arial"}.c46{color:#000000}.c12{background-color:#cccccc}.c28{margin-left:18pt}.c51{background-color:#d9d9d9}.c39{background-color:#ffffff}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:24pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:14pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}h5{padding-top:11pt;color:#666666;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:10pt;color:#666666;font-size:10pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style><p class="c5"><span class="c44">How to Add a Property to a Component</span></p><p class="c5"><span class="c11 c16">Originally created by Kate Feeney</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c11 c16">This document describes how to add a new property to an existing App Inventor component.</span></p><p class="c3"><span class="c11 c44 c48"></span></p><p class="c5 c20 c28"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.tx5i6z3qbwfd">1. Adding a Property to the Properties Panel</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.5ung7bouowf8">1.1 PropertyEditors</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.2f89e3ho2aba">1.2 Creating a New PropertyEditor</a></span></p><p class="c5 c10"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.tmii3aset5ig">1.2.1 Creating the new PropertyEditor class</a></span></p><p class="c5 c10"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.vsevvombot03">1.2.2 Adding the New PropertyEditor to the Properties Panel</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.sxo7g7vfiim2">1.3. Associate the Property with the Component</a></span></p><p class="c5 c20 c28"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.tlwyymw24q12">2. Changing the Designer View When a Property Changes</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.3dd9z4pi8aks">2.1 Change Component’s Attributes</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.ebf6qm850wmr">2.2 Update the onPropertyChange Method</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.5etr1jfocapb">2.3 Update Any Other Necessary Methods</a></span></p><p class="c5 c20 c28"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.icechgyjfstl">3. Changing the Android Representation of the Component</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.xdqyaynnmdzs">3.1. Button Shape Example</a></span></p><p class="c5 c20 c28"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.2g0jyctaq6go">4. Update Version Numbers</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.gpn6v5m6qo2">4.1 YaVersion</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.si39bcfsv8bl">4.2 YoungAndroidFormUpgrader</a></span></p><p class="c5 c19"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.psfo74spnt8y">4.3 BlockSaveFile</a></span></p><p class="c5 c20 c28"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.vsfxd7ls6pw7">5. Deprecating methods and events and properties</a></span></p><p class="c5 c20 c28"><span class="c25"><a class="c7" href="https://docs.google.com/document/d/1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs/pub#h.ek4afml69u22">6. Internationalization</a></span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>As an example, we will show how the Shape property was added to the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg//com/google/appinventor/components/runtime/ButtonBase.html&amp;sa=D&amp;ust=1539767126841000">ButtonBase</a></span><span>&nbsp;c</span><span>omponent</span><span>. &nbsp;ButtonBase is a</span><span>n abstract</span><span>&nbsp;superclass of the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/components/runtime/Button.html&amp;sa=D&amp;ust=1539767126842000">Button</a></span><span>&nbsp;</span><span>and the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/components/runtime/Picker.html&amp;sa=D&amp;ust=1539767126842000">Picker</a></span><span>&nbsp;components</span><span>&nbsp;(</span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg//com/google/appinventor/components/runtime/ContactPicker.html&amp;sa=D&amp;ust=1539767126843000">ContactPicker</a></span><span>, </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg//com/google/appinventor/components/runtime/ImagePicker.html&amp;sa=D&amp;ust=1539767126843000">ImagePicker</a></span><span>&nbsp;and </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg//com/google/appinventor/components/runtime/ListPicker.html&amp;sa=D&amp;ust=1539767126843000">ListPicker</a></span><span>)</span><span>;</span><span>&nbsp;therefore</span><span>,</span><span>&nbsp;all properties defined for ButtonBase are also defined for Button and Picker. &nbsp;Originally the ButtonBase component </span><span>had no Shape propert</span><span>y; it simply used the default shape</span><span>, which </span><span>uses the system’s defaults and varies from device to device.</span><span>&nbsp; </span><span>When the Shape property was added</span><span>,</span><span>&nbsp;four choices (default, rounded, rectangular and oval) were included.</span><span>&nbsp;All examples in this document </span><span>show</span><span class="c11 c16">&nbsp;the Button component but would be the same for any of the Picker components.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>The user will first see the new property in the Button component's Properties panel in the Designer. Because the choices should be restricted to the four legal values, we will create a </span><span>PropertyEditor</span><span>&nbsp;that limits the choices to these values and maps them to integers for the internal representation of the property. When the user changes the value of the Shape property, the visual representation of the Button component in the Designer must change so that the user can preview the interface. &nbsp;To do this we will create a method that will change the attributes of the GWT button widget that represents the Button component in the Designer. Finally, since the user ultimately wants the property changed on their Android device we will add code that changes the Button view’s BackgroundDrawable depending on which Shape value is selected.</span></p><h2 class="c21" id="h.tx5i6z3qbwfd"><span class="c11 c24">1. Adding a Property to the Properties Panel</span></h2><p class="c5"><span>The first step is to add the property so that it appears in the </span><span>Properties</span><span>&nbsp;panel when a Button is selected. &nbsp;This change is shown in the image below. &nbsp;</span><span>Every property is associated with a PropertyEditor to allow the user to choose among legal values. &nbsp;</span><span>Often, an existing PropertyEditor can be used, but in some cases, such as the </span><span>Shape property, it will be necessary to create a</span><span>&nbsp;new one</span><span>.</span><span>&nbsp; </span><span>Finally, we will associate the property with the component so that the property will appear in the Properties panel when the component is selected.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 656.00px; height: 492.00px;"><img alt="" src="./How to Add a Property to A Component_files/PropertiesPanel.jpg" style="width: 656.00px; height: 492.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c32"><span class="c22">Figure 1: Button Property Panel</span></p><h3 class="c40" id="h.5ung7bouowf8"><span class="c46">1.1</span><span class="c46">&nbsp;PropertyEditor</span><span class="c46">s</span></h3><p class="c5"><span>E</span><span>ach property has a </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/widgets/properties/PropertyEditor.html&amp;sa=D&amp;ust=1539767126846000">PropertyEditor</a></span><span>&nbsp;that controls what values can be specified in the Designer. </span><span>Some existing PropertyEditors include the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/widgets/properties/BooleanPropertyEditor.html&amp;sa=D&amp;ust=1539767126847000">BooleanPropertyEditor</a></span><span>&nbsp;(used by ButtonBase.Enabled), </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/widgets/properties/NonNegativeFloatPropertyEditor.html&amp;sa=D&amp;ust=1539767126847000">NonNegativeFloatPropertyEditor</a></span><span>&nbsp;(used by ButtonBase.FontSize) and </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/widgets/properties/TextPropertyEditor.html&amp;sa=D&amp;ust=1539767126848000">TextPropertyEditor</a></span><span>&nbsp;(used by ButtonBase.Text</span><span>). </span><span>If a suitable PropertyEditor already exists </span><span>(</span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/widgets/properties/package-summary.html&amp;sa=D&amp;ust=1539767126848000">Check if an existing property will meet your needs.</a></span><span>)</span><span>,</span><span class="c11 c16">&nbsp;then simply note its name and skip to Section 1.3. &nbsp;Otherwise a new PropertyEditor needs to be created as described in Section 1.2. &nbsp;</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>The</span><span>&nbsp;</span><span>PropertyEditor</span><span>&nbsp;associated with the Shape property must offer a drop-down menu with the four legal shape values: default, rounded, rectangular and oval </span><span>(as shown below). </span><span>Since this does not already exist, a new PropertyEditor must be created.</span></p><p class="c3"><span class="c16 c46 c47"></span></p><p class="c3"><span class="c11 c16"></span></p><p class="c32"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 109.00px; height: 92.00px;"><img alt="" src="./How to Add a Property to A Component_files/ShapePropSelected.png" style="width: 109.00px; height: 92.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c32"><span class="c22">Figure 2: Shape </span><span class="c22">PropertyEditor</span><span class="c9">&nbsp;in the Designer</span></p><h3 class="c40" id="h.2f89e3ho2aba"><span class="c11 c38">1.2 Creating a New PropertyEditor</span></h3><h4 class="c23" id="h.tmii3aset5ig"><span class="c30">1.2.1 Creating the new PropertyEditor class</span></h4><p class="c5"><span>The new PropertyEditor class must extend the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/widgets/properties/PropertyEditor.html&amp;sa=D&amp;ust=1539767126850000">PropertyEditor</a></span><span>&nbsp;class and restrict the user inputs to only legal values. This class will also define </span><span>how</span><span class="c11 c16">&nbsp;the PropertyEditor is displayed to the user (drop-down menu, text box, etc.).</span></p><p class="c3"><span class="c11 c27"></span></p><p class="c5"><span>For our example the new class will be called </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/editor/youngandroid/properties/YoungAndroidButtonShapeChoicePropertyEditor.html&amp;sa=D&amp;ust=1539767126851000">YoungAndroidButtonShapeChoicePropertyEditor</a></span><span>&nbsp;and it will extend the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/widgets/properties/ChoicePropertyEditor.html&amp;sa=D&amp;ust=1539767126851000">ChoicePropertyEditor</a></span><span>&nbsp;class</span><span>,</span><span>&nbsp;which itself </span><span>extends </span><span>PropertyEditor</span><span>. This new class must define an array of </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/widgets/properties/ChoicePropertyEditor.Choice.html&amp;sa=D&amp;ust=1539767126852000">Choice</a></span><span>&nbsp;objects </span><span>and pass th</span><span>e</span><span>&nbsp;array to the ChoicePropertyEditor </span><span>constructor, </span><span>which will create the drop</span><span>-</span><span>down choice widget. A Choice is a static class defined in the ChoicePropertyEditor class and its constructor takes in two strings: </span><span class="c42">caption </span><span>and </span><span class="c42">v</span><span class="c42">alue</span><span>. &nbsp;</span><span>The</span><span>&nbsp;</span><span class="c42">caption</span><span>&nbsp;string is text to be shown in the drop</span><span>-</span><span>down choice widget. The </span><span class="c42">value</span><span>&nbsp;string is the value assigned to the property if the choice is selected</span><span>.</span><span class="c11 c16">&nbsp;The new class is defined in Figure 4.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>The first step is to define the four descriptive strings (</span><span class="c42">caption</span><span>&nbsp;strings), which are displayed to the user and will be placed in the array passed to the ChoicePropertyEditor. &nbsp;</span><span>This</span><span>&nbsp;is done by adding the following code to the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/OdeMessages.html&amp;sa=D&amp;ust=1539767126854000">OdeMessages</a></span><span class="c11 c16">&nbsp;interface. The reason the strings are defined in a separate file rather than hard-coded is to support abstraction and internationalization. </span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c1 c26">//Used in editor/youngandroid/properties/YoungAndroidButtonShapeChoicePropertyEditor.java</span></p><p class="c3"><span class="c0"></span></p><p class="c5"><span class="c1">&nbsp;@DefaultMessage(</span><span class="c1 c6">"default"</span><span class="c1">) &nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 237.00px; height: 12.00px;"><img alt="" src="./How to Add a Property to A Component_files/thisiswhat.png" style="width: 237.00px; height: 12.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c1">&nbsp;@Description(</span><span class="c1 c6">"Text for button shape choice 'default'"</span><span class="c1">)</span><span class="c1">&nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 152.00px; height: 24.00px;"><img alt="" src="./How to Add a Property to A Component_files/thisstringis.png" style="width: 152.00px; height: 24.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c1">&nbsp;String </span><span class="c1">defaultButtonShape</span><span class="c1">()</span><span class="c11 c1">;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 182.00px; height: 26.00px;"><img alt="" src="./How to Add a Property to A Component_files/thisstringvalue.png" style="width: 182.00px; height: 26.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c1">&nbsp;@DefaultMessage(</span><span class="c1 c6">"rounded"</span><span class="c11 c1">)</span></p><p class="c5"><span class="c1">&nbsp;@Description(</span><span class="c1 c6">"Text for button shape choice 'rounded'"</span><span class="c11 c1">)</span></p><p class="c5"><span class="c11 c1">&nbsp;String roundedButtonShape();</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c1">&nbsp;@DefaultMessage(</span><span class="c1 c6">"rectangular"</span><span class="c11 c1">)</span></p><p class="c5"><span class="c1">&nbsp;@Description(</span><span class="c1 c6">"Text for button shape choice 'rectangular'"</span><span class="c11 c1">)</span></p><p class="c5"><span class="c11 c1">&nbsp;String rectButtonShape();</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c1">&nbsp;@DefaultMessage(</span><span class="c1 c6">"oval"</span><span class="c11 c1">)</span></p><p class="c5"><span class="c1">&nbsp;@Description(</span><span class="c1 c6">"Text for button shape choice 'oval'"</span><span class="c11 c1">)</span></p><p class="c5"><span class="c1">&nbsp;String ovalButtonShape();</span></p><p class="c32"><span class="c22">Figure 3: Define Strings in OdeMessages c</span><span class="c22">lass </span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>Now that the strings are define</span><span>d</span><span>,</span><span class="c11 c16">&nbsp;the YoungAndroidButtonShapeEditor class can be created as shown in Figure 4.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c2">package</span><span class="c11 c1">&nbsp;com.google.appinventor.client.editor.youngandroid.properties;</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">import static</span><span class="c1">&nbsp;com.google.appinventor.client.Ode.</span><span class="c1 c6">MESSAGES</span><span class="c11 c1">;</span></p><p class="c5"><span class="c2">import</span><span class="c11 c1">&nbsp;com.google.appinventor.client.widgets.properties.ChoicePropertyEditor;</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c1 c15 c6">/**</span></p><p class="c5"><span class="c1 c15 c6">&nbsp;* Property editor for button style.</span></p><p class="c5"><span class="c1 c15 c6">&nbsp;* </span></p><p class="c5"><span class="c1 c15 c6">&nbsp;* @author feeney.kate@gmail.com (Kate Feeney)</span></p><p class="c5"><span class="c1 c15 c6">&nbsp;*/</span></p><p class="c5"><span class="c2">public class</span><span class="c1">&nbsp;YoungAndroidButtonShapeChoicePropertyEditor </span><span class="c2">extends</span><span class="c1">&nbsp;</span><span class="c1">ChoicePropertyEditor</span><span class="c11 c1">&nbsp;{</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c0">// Button shape choices</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 154.00px; height: 30.00px;"><img alt="" src="./How to Add a Property to A Component_files/extendChoice.png" style="width: 154.00px; height: 30.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">private static final</span><span class="c1">&nbsp;Choice[] </span><span class="c1 c6">shapes</span><span class="c11 c1">&nbsp;= new Choice[] {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c2">new</span><span class="c1">&nbsp;Choice(</span><span class="c1 c6">MESSAGES</span><span class="c1">.defaultButtonShape(), </span><span class="c1 c6">"0"</span><span class="c11 c1">), &nbsp; &nbsp;</span></p><p class="c5"><span class="c2">&nbsp; &nbsp;</span><span class="c2">&nbsp;new</span><span class="c1">&nbsp;Choice(</span><span class="c1 c6">MESSAGES</span><span class="c1">.roundedButtonShape(), </span><span class="c1 c6">"1"</span><span class="c11 c1">)</span></p><p class="c5"><span class="c2">&nbsp; &nbsp; new</span><span class="c1">&nbsp;Choice(</span><span class="c1 c6">MESSAGES</span><span class="c1">.rectButtonShape(), </span><span class="c1 c6">"2"</span><span class="c11 c1">),</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 98.00px; height: 24.00px;"><img alt="" src="./How to Add a Property to A Component_files/definean.png" style="width: 98.00px; height: 24.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c2">new</span><span class="c1">&nbsp;Choice(</span><span class="c1 c6">MESSAGES</span><span class="c1">.ovalButtonShape(), </span><span class="c1 c6">"3"</span><span class="c11 c1">)</span></p><p class="c5"><span class="c11 c1">&nbsp; };</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">public</span><span class="c11 c1">&nbsp;YoungAndroidButtonShapeChoicePropertyEditor() {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp;</span><span class="c2">super</span><span class="c1">(</span><span class="c1 c6">shapes</span><span class="c11 c1">);</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 195.00px; height: 27.00px;"><img alt="" src="./How to Add a Property to A Component_files/passarray.png" style="width: 195.00px; height: 27.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">}</span></p><p class="c32"><span class="c22">Figure 4: YoungAndroidButtonShapeEditor c</span><span class="c22">lass</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span>The </span><span class="c42">value</span><span>&nbsp;strings (e.g., “0”, “1”, “2”, “3” in Figure 4) </span><span>will be assigned to the property and can be</span><span>&nbsp;accessed via</span><span>&nbsp;the component’s getter</span><span>s and setters. &nbsp;</span><span>When the string is retrieved by the component’s getter it will be retrieved as an </span><span>int</span><span>&nbsp;for which constants should be defined in the Component class. W</span><span>e </span><span>will define the constants in the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/components/runtime/Component.html&amp;sa=D&amp;ust=1539767126864000">Component</a></span><span>&nbsp;class since all components inherit from it. Therefore the following code (Figure 5) is to be added. </span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c1 c15 c41">&nbsp; /*</span></p><p class="c5"><span class="c1 c15 c41">&nbsp; &nbsp;* Button Styles.</span></p><p class="c5"><span class="c1 c15 c41">&nbsp; &nbsp;*/</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">BUTTON_SHAPE_DEFAULT</span><span class="c11 c1">&nbsp;= 0;</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">BUTTON_SHAPE_ROUNDED</span><span class="c11 c1">&nbsp;= 1;</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">BUTTON_SHAPE_RECT</span><span class="c11 c1">&nbsp;= 2;</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">BUTTON_SHAPE_OVAL</span><span class="c1">&nbsp;= 3;</span></p><p class="c32"><span class="c22">Figure 5: Define </span><span class="c42 c22">value</span><span class="c22">&nbsp;</span><span class="c22">Strings in the Component class</span></p><p class="c3"><span class="c30"></span></p><p class="c3"><span class="c9"></span></p><h4 class="c23" id="h.vsevvombot03"><span>1.2.2 Adding the New PropertyEditor to the Properties Panel &nbsp;</span></h4><p class="c5"><span>The </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=https://code.google.com/p/app-inventor/source/browse/appinventor/appengine/src/com/google/appinventor/client/editor/youngandroid/palette/YoungAndroidPalettePanel.java&amp;sa=D&amp;ust=1539767126867000">YoungAndroidPalettePanel</a></span><span>&nbsp;class </span><span>creates the component palette on the left side of the Designer and instantiates the components’ PropertyEditors.</span><span>&nbsp;We need to add the logic to do this in the </span><span>createPropertyEditor</span><span>() method. &nbsp;First, we need to define a constant for the property in the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/components/common/ComponentConstants.html&amp;sa=D&amp;ust=1539767126867000">propertyTypeContants</a></span><span>&nbsp;class. </span><span>Add the following code.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c11 c1">&nbsp; /**</span></p><p class="c5"><span class="c1">&nbsp; * Button shapes. &nbsp;* @see </span><span class="c11 c42 c50">com.google.appinventor.client.editor.youngandroid.properties.</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c11 c42 c50">&nbsp; * YoungAndroidButtonShapeChoicePropertyEditor</span></p><p class="c5"><span class="c11 c1">&nbsp; */</span></p><p class="c5"><span class="c1">&nbsp; public static final String PROPERTY_TYPE_BUTTON_SHAPE = </span><span class="c1">"</span><span class="c1 c6">button_shape</span><span class="c1">";</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c11 c16">Then add the following case to the createPropertyEditor() method inside the same class.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c1">&nbsp; &nbsp; } </span><span class="c2">else if</span><span class="c1">&nbsp;(editorType.equals</span><span class="c1 c39">(PropertyTypeConstants.PROPERTY_TYPE_BUTTON_SHAPE)</span><span class="c11 c1">) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c2">return new </span><span class="c11 c1">YoungAndroidButtonShapeChoicePropertyEditor();</span></p><p class="c32"><span class="c22">Figure 6: Addition to </span><span class="c22">YoungAndroidPalettePanel.</span><span class="c22">createPropertyEditor</span><span class="c22">()</span></p><h3 class="c40" id="h.sxo7g7vfiim2"><span class="c11 c38">1.3. Associate the Property with the Component</span></h3><p class="c5"><span>Create a setter and a getter method for the new property in the component’s class. </span><span>Both the setter and the getter methods must be marked with the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/components/annotations/SimpleProperty.html&amp;sa=D&amp;ust=1539767126870000">SimpleProperty</a></span><span>&nbsp;</span><span>annotation. &nbsp;The SimpleProperty annotation consists of a description, the property’s category and whether or not the property is visible (visible</span><span>&nbsp;in the BlocksEditor</span><span>). The setter method must also be marked with the DesignerProperty annotation. &nbsp;This annotation consists of the property’s editor type, which is defined in the DesignerProperty </span><span>annotation</span><span>, and the default value of the property</span><span>.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>For this example the following code needs to be added to the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/components/runtime/ButtonBase.html&amp;sa=D&amp;ust=1539767126871000">ButtonBase</a></span><span class="c11 c16">&nbsp;class.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>This is the getter:</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; /**</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* Returns the style of the button.</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;*</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* @return &nbsp;one of {@link Component#BUTTON_SHAPE_DEFAULT},</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{@link Component#BUTTON_SHAPE_ROUNDED},</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{@link Component#BUTTON_SHAPE_RECT} or</span></p><p class="c5"><span class="c1 c6 c15">&nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{@link Component#BUTTON_SHAPE_OVAL}</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;*/</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 173.00px; height: 26.00px;"><img alt="" src="./How to Add a Property to A Component_files/thedesc.png" style="width: 173.00px; height: 26.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c11 c1">&nbsp; @SimpleProperty(</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; category = PropertyCategory.APPEARANCE</span><span class="c1">,</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; userVisible = </span><span class="c13">false</span><span class="c11 c1">)</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 145.00px; height: 39.00px;"><img alt="" src="./How to Add a Property to A Component_files/falsesince.png" style="width: 145.00px; height: 39.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">public int</span><span class="c11 c1">&nbsp;Shape() {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c13">return</span><span class="c11 c1">&nbsp;shape;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 139.00px; height: 49.00px;"><img alt="" src="./How to Add a Property to A Component_files/thenameof.png" style="width: 139.00px; height: 49.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c9"></span></p><p class="c3"><span class="c11 c1"></span></p><p class="c3"><span class="c11 c1"></span></p><p class="c32"><span class="c9">Figure 7: Shape Getter</span></p><p class="c31"><span class="c11 c1"></span></p><p class="c5"><span>This is the </span><span>setter:</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; /**</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* Specifies the style the button. This does not check that the argument is a legal &nbsp; &nbsp;</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* value.</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;*</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* @param shape one of {@link Component#BUTTON_SHAPE_DEFAULT}, </span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{@link Component#BUTTON_SHAPE_ROUNDED},</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{@link Component#BUTTON_SHAPE_RECT} or</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{@link Component#BUTTON_SHAPE_OVAL}</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* &nbsp; </span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;* @throws IllegalArgumentException if shape is not a legal value.</span></p><p class="c5"><span class="c1 c15 c6">&nbsp; &nbsp;*/</span></p><p class="c5"><span class="c11 c1">&nbsp; @DesignerProperty(editorType = PropertyTypeConstants.PROPERTY_TYPE_BUTTON_SHAPE,</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; defaultValue = Component.BUTTON_SHAPE_DEFAULT + </span><span class="c1 c6">""</span><span class="c11 c1">)</span></p><p class="c5"><span class="c1">&nbsp; @</span><span class="c1">SimpleProperty</span><span class="c1">(</span><span class="c11 c1 c39">description = "Specifies the button's shape (default, rounded," +</span></p><p class="c5"><span class="c11 c1 c39">&nbsp; &nbsp; &nbsp; " rectangular, oval). The shape will not be visible if an Image is being + &nbsp; &nbsp;</span></p><p class="c5"><span class="c1 c39">&nbsp; &nbsp; &nbsp; displayed.", </span><span class="c1">userVisible = </span><span class="c13">false</span><span class="c1 c11">)</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">public void</span><span class="c1">&nbsp;Shape(</span><span class="c13">int</span><span class="c11 c1">&nbsp;shape) {</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 236.00px; height: 27.00px;"><img alt="" src="./How to Add a Property to A Component_files/thecateg.png" style="width: 236.00px; height: 27.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c13">this.</span><span class="c11 c1">shape = shape;</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; updateAppearance();</span></p><p class="c5"><span class="c1">&nbsp; }</span></p><p class="c32"><span class="c9">Figure 8: Shape Setter</span></p><p class="c3"><span class="c9"></span></p><p class="c5"><span>Then define the variable shape</span><span>&nbsp;</span><span class="c11 c16">inside the same file with the following code.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c1">&nbsp;</span><span class="c1 c15 c41">&nbsp;// Backing for button shape</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">private int</span><span class="c1">&nbsp;</span><span class="c1 c6">shape</span><span class="c11 c1">;</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c11 c16">And add the following line to the ButtonBase constructor.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c1">Shape(Component.</span><span class="c1 c6">BUTTON_SHAPE_DEFAULT</span><span class="c1">);</span><span class="c11 c48 c49">&nbsp;</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>After implementing the code in this section, the Shape property will appear in the Properties panel when a Button</span><span>&nbsp;</span><span>is selected in the designer view; </span><span>however</span><span>, changing the property does not yet affect the appearance of the Button</span><span>.</span></p><h2 class="c21" id="h.tlwyymw24q12"><span class="c11 c24">2. Changing the Designer View When a Property Changes</span></h2><p class="c5"><span>The app’s user interface can be viewed in two locations. &nbsp;The first location is in </span><span>the </span><span class="c11 c16">Designer and the second is on the Android device (i.e. phone, tablet or emulator). &nbsp;The Designer is the view shown in the browser window and is what will be changed in this section.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>Every </span><span>Component </span><span>has a corresponding mock class in the appengine</span><span>&nbsp;</span><span>project. &nbsp;The mock class is the visual representation of the component in the Designer, and the </span><span>mock classes generally follow the same hierarchy as the Component classes. &nbsp;</span><span>If your property changes visual aspects of the component </span><span>(such as color)</span><span>, &nbsp;then the mock class of that component must adjust the Designer to show these visual changes.</span></p><h3 class="c40" id="h.3dd9z4pi8aks"><span class="c11 c38">2.1 Change Component’s Attributes</span></h3><p class="c5"><span>There are already a number of methods written to change a component’s attributes in </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/editor/simple/components/MockComponent.html&amp;sa=D&amp;ust=1539767126878000">MockComponent</a></span><span>, </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/editor/simple/components/MockComponentsUtil.html&amp;sa=D&amp;ust=1539767126878000">MockComponentsUtil</a></span><span>&nbsp;and &nbsp;</span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/editor/simple/components/MockVisibleComponent.html&amp;sa=D&amp;ust=1539767126878000">MockVisibleComponent</a></span><span>; </span><span>most </span><span class="c11 c16">component mock classes inherit from at least one of these classes. &nbsp;</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>To </span><span>change the appearance in the Designer, find the mock class that corresponds to the component to which the property was added. Determine if the class inherits a method that changes the appropriate attribute. &nbsp;</span><span>If such a method exists, then simply write a method that calls that method with the appropriate arguments, as done in the setEnabledProperty() method in the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=https://code.google.com/p/app-inventor/source/browse/appinventor/appengine/src/com/google/appinventor/client/editor/simple/components/MockButtonBase.java&amp;sa=D&amp;ust=1539767126879000">MockButtonBase</a></span><span>&nbsp;class. If a method doesn’t exist then follow this Shape property example.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>For this example the mock class associated with the ButtonBase component is </span><span>MockButtonBa</span><span>se</span><span>. </span><span>Figure 9 shows the appearances for each value of the Shape property.</span></p><p class="c31"><span class="c11 c16"></span></p><a id="t.174991c71c0a9f41278a8303934a94c87588720e"></a><a id="t.0"></a><table class="c33"><tbody><tr class="c18"><td class="c14" colspan="1" rowspan="1"><p class="c17"><span class="c11 c43">Shape</span></p></td><td class="c29" colspan="1" rowspan="1"><p class="c17"><span class="c11 c43">Image</span></p></td></tr><tr class="c18"><td class="c14" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">default</span></p></td><td class="c29" colspan="1" rowspan="1"><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 146.00px; height: 41.00px;"><img alt="" src="./How to Add a Property to A Component_files/defaultdesigner.png" style="width: 146.00px; height: 41.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c18"><td class="c14" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">rounded</span></p></td><td class="c29" colspan="1" rowspan="1"><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 146.00px; height: 43.00px;"><img alt="" src="./How to Add a Property to A Component_files/rounddesigner.png" style="width: 146.00px; height: 43.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c18"><td class="c14" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">rectangular</span></p></td><td class="c29" colspan="1" rowspan="1"><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 146.00px; height: 46.00px;"><img alt="" src="./How to Add a Property to A Component_files/rectangulardesigner.png" style="width: 146.00px; height: 46.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c18"><td class="c14" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">oval</span></p></td><td class="c29" colspan="1" rowspan="1"><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 146.00px; height: 75.00px;"><img alt="" src="./How to Add a Property to A Component_files/ovaldesigner.png" style="width: 146.00px; height: 75.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr></tbody></table><p class="c32"><span class="c9">Figure 9: Mock Buttons</span></p><p class="c31"><span class="c11 c16"></span></p><p class="c5"><span>Mock components are built on top of GWT widgets. &nbsp;The MockButtonBase creates a button widget which uses the system’s defaults and in order to make the above shapes the button’s corner radii needs to be changed. &nbsp;</span><span>There does not already exist a method in MockButtonBase or any of its superclasses that could change a button’s corner radii, so the following method (Figure 10) needs to be added to MockButtonBase.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c0">&nbsp; // Legal values for shape are defined in</span></p><p class="c5"><span class="c0">&nbsp; // com.google.appinventor.components.runtime.Component.java.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">private int</span><span class="c11 c1">&nbsp;shape;</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c0">&nbsp; /*</span></p><p class="c5"><span class="c0">&nbsp; &nbsp;* Sets the button's Shape property to a new value.</span></p><p class="c5"><span class="c0">&nbsp; &nbsp;*/</span></p><p class="c5"><span class="c2">&nbsp; private void</span><span class="c11 c1">&nbsp;setShapeProperty(String text) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c1 c6">shape</span><span class="c11 c1">&nbsp;= Integer.parseInt(text);</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; // Android Buttons with images take the shape of the image and do not</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; // use one of the defined Shapes.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp;</span><span class="c2">&nbsp;if </span><span class="c1">(</span><span class="c1 c6">hasImage</span><span class="c11 c1">) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c2">return</span><span class="c11 c1">;</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c2">switch</span><span class="c1">(</span><span class="c1 c6">shape</span><span class="c11 c1">) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c2">case</span><span class="c11 c1">&nbsp;0:</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c0">// Default Button</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; DOM.setStyleAttribute(</span><span class="c1 c6">buttonWidget</span><span class="c1">.getElement(), </span><span class="c1 c6">"border-radius"</span><span class="c1">, </span><span class="c1 c6">"0px"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">break</span><span class="c11 c1">;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c2">case </span><span class="c1">1</span><span class="c11 c1">:</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // Rounded Button.</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // The corners of the Button are rounded by 10 px.</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // The value 10 px was chosen strictly for style.</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // 10 px is the same as ROUNDED_CORNERS_RADIUS defined in </span></p><p class="c5"><span class="c1 c26">&nbsp; &nbsp; &nbsp; &nbsp; // com.google.appinventor.components.runtime.ButtonBase.java. &nbsp;</span><span class="c11 c1">&nbsp; &nbsp; &nbsp; </span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; DOM.setStyleAttribute(</span><span class="c1 c6">buttonWidget</span><span class="c1">.getElement(), </span><span class="c1 c6">"border-radius"</span><span class="c1">, </span><span class="c1 c6">"10px"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c2">&nbsp; break</span><span class="c11 c1">;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp;</span><span class="c2">&nbsp;case </span><span class="c1">2</span><span class="c11 c1">:</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // Rectangular Button</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; DOM.setStyleAttribute(</span><span class="c1 c6">buttonWidget</span><span class="c1">.getElement(), </span><span class="c1 c6">"border-radius"</span><span class="c1">, </span><span class="c1 c6">"0px"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; &nbsp; break;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c2">case </span><span class="c1">3</span><span class="c11 c1">:</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp;</span><span class="c0">&nbsp; &nbsp;// Oval Button</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; String height = DOM.getStyleAttribute(</span><span class="c1 c6">buttonWidget</span><span class="c1">.getElement(), </span><span class="c1 c6">"height"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; DOM.setStyleAttribute(</span><span class="c1 c6">buttonWidget</span><span class="c1">.getElement(), </span><span class="c1 c6">"border-radius"</span><span class="c11 c1">, height);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">break</span><span class="c11 c1">;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp;</span><span class="c2">&nbsp;default</span><span class="c11 c1">:</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">&nbsp; &nbsp; // This should never happen</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">throw new</span><span class="c1">&nbsp;IllegalArgumentException(</span><span class="c1 c6">"shape:"</span><span class="c1">&nbsp;+ </span><span class="c1 c6">shape</span><span class="c11 c1">);</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; }</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c32"><span class="c22">Figure 10: Addition to MockButtonBase Class</span></p><h3 class="c40" id="h.ebf6qm850wmr"><span class="c11 c38">2.2 Update the onPropertyChange Method</span></h3><p class="c5"><span>Mock component classes contain</span><span>&nbsp;an onPropertyChange() method which is called by GWT when any of the component’s properties are changed and it determines</span><span>&nbsp;how</span><span>&nbsp;to change the view in the Designer. &nbsp;The onPropertyChange() method </span><span>has two string parameters</span><span>, the </span><span class="c42">propertyName </span><span>and the </span><span class="c42">newValue</span><span>. </span><span>&nbsp;The </span><span class="c42">propertyName</span><span>&nbsp;is a string representation of the name of the method defined in the property’s getter (also the string displayed in the Properties Panel).</span><span>&nbsp;</span><span>The </span><span class="c42">newValue</span><span>&nbsp;is the value of the property and is passed to the method that was just created.</span><span>&nbsp;For this example the </span><span class="c42">propertyName</span><span>&nbsp;would be “Shape” and the </span><span class="c42">newValue</span><span class="c11 c16">&nbsp;could be “0”, “1”, “2” or “3”.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>There is a list of all the possible </span><span class="c42">propertyName</span><span>&nbsp;values in the </span><span>MockVisibleComponent</span><span class="c11 c16">&nbsp;class. The new property needs to be added to the list. &nbsp;For this example add the following line.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">protected static final</span><span class="c1">&nbsp;String </span><span class="c1 c6">PROPERTY_NAME_BUTTONSHAPE</span><span class="c1">= </span><span class="c1 c6">"Shape"</span><span class="c1">;</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c11 c16">Now back in the mock component’s class add logic so that if the new property is changed it will call the method that was just created.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c11 c16">For this example add the following statement to the onPropertyChange() method of the MockButtonBase class</span></p><p class="c3"><span class="c11 c16 c51"></span></p><p class="c5"><span class="c1">&nbsp; &nbsp; } </span><span class="c2">else if </span><span class="c1">(propertyName.equals(</span><span class="c1 c6">PROPERTY_NAME_BUTTONSHAPE</span><span class="c11 c1">)){</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 141.00px; height: 24.00px;"><img alt="" src="./How to Add a Property to A Component_files/thisisthestringjust.png" style="width: 141.00px; height: 24.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; setShapeProperty(newValue);</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 140.00px; height: 24.00px;"><img alt="" src="./How to Add a Property to A Component_files/thisisthemethod.png" style="width: 140.00px; height: 24.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c11 c1"></span></p><p class="c3"><span class="c9"></span></p><p class="c32"><span class="c22">Figure 11: Additon to onPropertyChange()</span></p><p class="c3"><span class="c11 c1"></span></p><h3 class="c40" id="h.5etr1jfocapb"><span class="c11 c38">2.3 Update Any Other Necessary Methods</span></h3><p class="c5"><span class="c11 c16">If changing the new property doesn’t affect any other properties then this section is complete. It might be a good idea to review the methods in the mock component class to confirm this. &nbsp;If the new property does affect other properties then update the methods called on those property changes as needed. </span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>For this example, since the button shape only changes if there is no background image, the Shape property and the Image property affect each other. </span><span>&nbsp;Therefore, since the setShapeProperty() method was created (or updated), the setImageProperty() method needs to be updated.</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span>The following two gray lines need to be added to the setImageProperty()</span><span class="c1">&nbsp;</span><span class="c11 c16">method.</span></p><p class="c5"><span class="c11 c1">&nbsp; </span></p><p class="c5"><span class="c11 c1">&nbsp; /*</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp;* Sets the button's Image property to a new value.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp;*/</span></p><p class="c5"><span class="c11 c1">&nbsp; private void setImageProperty(String text) {</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; imagePropValue = text;</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; String url = convertImagePropertyValueToUrl(text);</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; if (url == null) {</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; hasImage = false;</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; url = "";</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; setBackgroundColorProperty(backgroundColor);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c11 c1 c12">setShapeProperty(Integer.toString(shape));</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; } else {</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; hasImage = true;</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; // Android Buttons do not show a background color if they have an image.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; // The container's background color shows through any transparent</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; // portions of the Image, an effect we can get in the browser by</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; // setting the widget's background color to COLOR_NONE.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; MockComponentsUtil.setWidgetBackgroundColor(buttonWidget,</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "&amp;H" + COLOR_NONE);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c1 c12">DOM.setStyleAttribute(buttonWidget.getElement(), </span><span class="c1 c6 c12">"border-radius"</span><span class="c1 c12">, </span><span class="c1 c6 c12">"0px"</span><span class="c11 c1 c12">);</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; }</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; MockComponentsUtil.setWidgetBackgroundImage(buttonWidget, url);</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; image.setUrl(url);</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c32"><span class="c9">Figure 12: Addition to setImageProperty()</span></p><p class="c31"><span class="c11 c16"></span></p><p class="c5"><span class="c11 c16">Now when the Shape property is changed the button shown in the designer view will also change to reflect the user’s preference. &nbsp;There will still be no change to the button on the Android device.</span></p><h2 class="c21" id="h.icechgyjfstl"><span>3. Changing the Android Representation of the Component </span></h2><p class="c5"><span class="c11 c16">Next decide how you would like to change the visual representation of the component on the Android device. &nbsp;Then implement the necessary code inside the class where you defined the property’s getter and setters.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>For the Shape property </span><span>the </span><span>component</span><span>’s BackgroundDrawable needs to be changed </span><span class="c11 c16">to change the shape. The table below describes how the ButtonBase component is changed for each Shape.</span></p><p class="c3"><span class="c11 c16"></span></p><a id="t.f18e50d752217f8efefb37ac400ea53eca740490"></a><a id="t.1"></a><table class="c33"><tbody><tr class="c18"><td class="c34" colspan="1" rowspan="1"><p class="c36"><span class="c11 c43">Shape</span></p></td><td class="c4" colspan="1" rowspan="1"><p class="c36"><span class="c11 c43">Image</span></p></td><td class="c35" colspan="1" rowspan="1"><p class="c36"><span class="c52">Drawable</span></p></td></tr><tr class="c18"><td class="c34" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">default</span></p></td><td class="c4" colspan="1" rowspan="1"><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 69.00px; height: 39.00px;"><img alt="" src="./How to Add a Property to A Component_files/defaultemulator.png" style="width: 69.00px; height: 39.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c35" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">defaultButtonDrawable or no drawable and set the background color</span></p></td></tr><tr class="c18"><td class="c34" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">rounded</span></p></td><td class="c4" colspan="1" rowspan="1"><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 74.00px; height: 34.00px;"><img alt="" src="./How to Add a Property to A Component_files/roundemulator.png" style="width: 74.00px; height: 34.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c35" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">RoundRectShape(CornerArray, null, null)</span></p><p class="c17"><span class="c11 c16">where CornerArray is and Array of 8 floats each with the value 10f.</span></p></td></tr><tr class="c18"><td class="c34" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">rectangular</span></p></td><td class="c4" colspan="1" rowspan="1"><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 74.00px; height: 35.00px;"><img alt="" src="./How to Add a Property to A Component_files/rectangularemulator.png" style="width: 74.00px; height: 35.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c35" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">RectShape() drawable</span></p></td></tr><tr class="c18"><td class="c34" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">oval</span></p></td><td class="c4" colspan="1" rowspan="1"><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 76.00px; height: 33.00px;"><img alt="" src="./How to Add a Property to A Component_files/ovalemulator.png" style="width: 76.00px; height: 33.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c35" colspan="1" rowspan="1"><p class="c17"><span class="c11 c16">OvalShape() drawable</span></p></td></tr></tbody></table><p class="c32"><span class="c22">Figure 13: &nbsp;Shape Drawables</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c11 c16">The process of changing the component on the Android device is very specific to both the component being changed and the property being added. &nbsp;Review the methods currently available to the component and components with similar properties to determine what code needs to be added or changed.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>The next section details the process followed when implementing the Shape property.</span></p><h3 class="c40" id="h.xdqyaynnmdzs"><span class="c11 c38">3.1. Button Shape Example</span></h3><p class="c5"><span>In the ButtonBase class </span><span>add the following constants.</span></p><p class="c5"><span class="c0">&nbsp; // Constant for shape</span></p><p class="c5"><span class="c0">&nbsp; // 10px is the radius of the rounded corners. &nbsp;</span></p><p class="c5"><span class="c0">&nbsp; // 10px was chosen for esthetic reasons.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">private static final float</span><span class="c11 c1">&nbsp;ROUNDED_CORNERS_RADIUS = 10f;</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">private static final float</span><span class="c1">[] ROUNDED_CORNERS_ARRAY = </span><span class="c13">new float</span><span class="c11 c1">[] { &nbsp; &nbsp; &nbsp;</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; ROUNDED_CORNERS_RADIUS,ROUNDED_CORNERS_RADIUS, ROUNDED_CORNERS_RADIUS, &nbsp; </span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; ROUNDED_CORNERS_RADIUS,ROUNDED_CORNERS_RADIUS, ROUNDED_CORNERS_RADIUS, &nbsp; </span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; ROUNDED_CORNERS_RADIUS,ROUNDED_CORNERS_RADIUS };</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c0">&nbsp; // Constant background color for buttons with a Shape other than default</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">private static final int</span><span class="c11 c1">&nbsp;SHAPED_DEFAULT_BACKGROUND_COLOR = Color.LTGRAY;</span></p><p class="c3"><span class="c11 c38"></span></p><p class="c5"><span class="c11 c16">Replace the updateAppearance() method with the following.</span></p><p class="c5"><span class="c0">&nbsp; // Update appearance based on values of backgroundImageDrawable, backgroundColor and &nbsp;</span></p><p class="c5"><span class="c0">&nbsp; // shape.</span></p><p class="c5"><span class="c0">&nbsp; // Images take precedence over background colors.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c13">private void</span><span class="c11 c1">&nbsp;updateAppearance() {</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; // If there is no background image, </span></p><p class="c5"><span class="c0">&nbsp; &nbsp; // the appearance depends solely on the background color and shape.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c13">if</span><span class="c11 c1">&nbsp;(backgroundImageDrawable == null) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c13">if</span><span class="c11 c1">&nbsp;(shape == Component.BUTTON_SHAPE_DEFAULT) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13">if</span><span class="c11 c1">&nbsp;(backgroundColor == Component.COLOR_DEFAULT) {</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // If there is no background image and color is default, </span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // restore original 3D bevel appearance.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; &nbsp; ViewUtil.setBackgroundDrawable(view, defaultButtonDrawable);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; } </span><span class="c13">else</span><span class="c11 c1">&nbsp;{</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c0">// Clear the background image.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ViewUtil.setBackgroundDrawable(view, </span><span class="c13">null</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c0">// Set to the specified color (possibly COLOR_NONE for transparent).</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TextViewUtil.setBackgroundColor(view, backgroundColor);</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; &nbsp; } &nbsp; </span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; }</span><span class="c13">&nbsp;else</span><span class="c11 c1">&nbsp;{</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // If there is no background image and the shape is something other than default,</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // create a drawable with the appropriate shape and color.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; &nbsp; setShape();</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; } </span><span class="c13">else</span><span class="c11 c1">&nbsp;{ </span></p><p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; // If there is a background image</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; ViewUtil.setBackgroundImage(view, backgroundImageDrawable);</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; }</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c32"><span class="c9">Figure 14: Addition to updateAppearance()</span></p><p class="c31"><span class="c11 c38"></span></p><p class="c5"><span>Add the setShape() method with the following.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c0">// Throw IllegalArgumentException if shape has illegal value. </span></p><p class="c5"><span class="c11 c1">&nbsp; private void setShape() {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; ShapeDrawable drawable = </span><span class="c13">new</span><span class="c11 c1">&nbsp;ShapeDrawable();</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Set color of drawable.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; drawable.getPaint().setColor((backgroundColor == Component.COLOR_DEFAULT) </span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;? shapedDefaultBackgroundColor : backgroundColor);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Set shape of drawable.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c13">switch</span><span class="c11 c1">&nbsp;(shape) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c13">case</span><span class="c11 c1">&nbsp;Component.BUTTON_SHAPE_ROUNDED:</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; drawable.setShape(</span><span class="c13">new</span><span class="c1">&nbsp;RoundRectShape(ROUNDED_CORNERS_ARRAY, </span><span class="c13">null</span><span class="c1">, </span><span class="c13">null</span><span class="c11 c1">));</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13">break</span><span class="c11 c1">;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c13">case</span><span class="c11 c1">&nbsp;Component.BUTTON_SHAPE_RECT:</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; drawable.setShape(</span><span class="c13">new </span><span class="c11 c1">RectShape());</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13">break</span><span class="c11 c1">;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c13">case</span><span class="c11 c1">&nbsp;Component.BUTTON_SHAPE_OVAL:</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; drawable.setShape(</span><span class="c13">new</span><span class="c11 c1">&nbsp;OvalShape());</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c13">&nbsp;break</span><span class="c11 c1">;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; </span><span class="c13">default</span><span class="c11 c1">:</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13">throw new</span><span class="c11 c1">&nbsp;IllegalArgumentException();</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; }</span></p><p class="c5"><span class="c1">&nbsp;</span><span class="c0">&nbsp; &nbsp;// Set drawable to the background of the button.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; view.setBackgroundDrawable(drawable);</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; view.invalidate();</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c32"><span class="c9">Figure 15: Addition to setShape()</span></p><p class="c31"><span class="c11 c1"></span></p><p class="c5"><span>Now when the Shape of a Button is changed both the Mock button and the Button on the Android device should change.</span></p><h2 class="c21" id="h.2g0jyctaq6go"><span class="c11 c24">4. Update Version Numbers</span></h2><h3 class="c40" id="h.gpn6v5m6qo2"><span class="c11 c38">4.1 YaVersion </span></h3><p class="c5"><span>The </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg//com/google/appinventor/components/common/YaVersion.html&amp;sa=D&amp;ust=1539767126914000">YaVersion</a></span><span class="c11 c16">&nbsp;class (in com.google.appinventor.components.common) defines the Young Android System version number, Blocks Language version number and Component version numbers. &nbsp;If the Blocks Language or any of the Components were updated in the previous sections then their version numbers and the Young Android System version number needs to be increased. &nbsp;There are also instructions, in the class, describing updating each of these values. &nbsp;</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>For the Button Shape example the ButtonBase component was updated, therefore the ButtonBase component version number needs to be increased along with the version numbers of components that are subclassed of ButtonBase and the Young Android System version number. &nbsp;</span><span>Add the following gray code to the YaVersion class.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c1">&nbsp;</span><span class="c0">// ............................ Young Android System Version Number &nbsp; </span></p><p class="c5"><span class="c0">&nbsp;// .............................</span></p><p class="c3"><span class="c0"></span></p><p class="c5"><span class="c0">&nbsp; // YOUNG_ANDROID_VERSION must be incremented when either the blocks language or a &nbsp;\</span></p><p class="c5"><span class="c0">&nbsp; // component changes.</span></p><p class="c5"><span class="c0">&nbsp; // TODO(lizlooney) - should this version number be generated so that it is &nbsp; </span></p><p class="c5"><span class="c0">&nbsp; // automatically incremented when the blocks language or a component changes?</span></p><p class="c3"><span class="c0"></span></p><p class="c5"><span class="c0">&nbsp; // For YOUNG_ANDROID_VERSION 2:</span></p><p class="c5"><span class="c0">&nbsp; // - The Logger component was removed. The Notifier component should be used instead.</span></p><p class="c5"><span class="c0">&nbsp; // - TINYWEBDB_COMPONENT_VERSION was incremented to 2.</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></p><p class="c5"><span class="c0 c12">&nbsp; // For YOUNG_ANDROID_VERSION 54:</span></p><p class="c5"><span class="c0 c12">&nbsp; // - BUTTON_COMPONENT_VERSION was incremented to 4.</span></p><p class="c5"><span class="c0 c12">&nbsp; // - CONTACTPICKER_COMPONENT_VERSION was incremented to 4.</span></p><p class="c5"><span class="c0 c12">&nbsp; // - IMAGEPICKER_COMPONENT_VERSION was incremented to 4.</span></p><p class="c5"><span class="c0 c12">&nbsp; // - LISTPICKER_COMPONENT_VERSION was incremented to 5.</span></p><p class="c5"><span class="c0 c12">&nbsp; // - PHONENUMBERPICKER_COMPONENT_VERSION was incremented to 4.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">public static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">YOUNG_ANDROID_VERSION</span><span class="c1">&nbsp;= </span><span class="c1 c12">54</span><span class="c11 c1">;</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c0">// For BUTTON_COMPONENT_VERSION 2:</span></p><p class="c5"><span class="c0">&nbsp; // - The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c0">&nbsp; // For BUTTON_COMPONENT_VERSION 3:</span></p><p class="c5"><span class="c0">&nbsp; // - The LongClick event was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; // For BUTTON_COMPONENT_VERSION 4:</span></p><p class="c5"><span class="c0 c12">&nbsp; // - The Shape property was added.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">public static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">BUTTON_COMPONENT_VERSION</span><span class="c1">&nbsp;= </span><span class="c1 c12">4</span><span class="c11 c1">;</span></p><p class="c3"><span class="c11 c1 c12"></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c0">// For CONTACTPICKER_COMPONENT_VERSION 2:</span></p><p class="c5"><span class="c0">&nbsp; // - The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c0">&nbsp; // For CONTACTPICKER_COMPONENT_VERSION 3:</span></p><p class="c5"><span class="c0">&nbsp; // - The method Open was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; // For CONTACTPICKER_COMPONENT_VERSION 4:</span></p><p class="c5"><span class="c0 c12">&nbsp; // - The Shape property was added.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">public static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">CONTACTPICKER_COMPONENT_VERSION</span><span class="c1">&nbsp;= </span><span class="c1 c12">4</span><span class="c11 c1">;</span></p><p class="c3"><span class="c11 c1 c12"></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c0">// For IMAGEPICKER_COMPONENT_VERSION 2:</span></p><p class="c5"><span class="c0">&nbsp; // - The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c0">&nbsp; // For IMAGEPICKER_COMPONENT_VERSION 3:</span></p><p class="c5"><span class="c0">&nbsp; // - The method Open was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; // For IMAGEPICKER_COMPONENT_VERSION 4:</span></p><p class="c5"><span class="c0 c12">&nbsp; // - The Shape property was added.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">public static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">IMAGEPICKER_COMPONENT_VERSION</span><span class="c1">&nbsp;= </span><span class="c1 c12">4</span><span class="c11 c1">;</span></p><p class="c3"><span class="c11 c1 c12"></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c0">// For LISTPICKER_COMPONENT_VERSION 2:</span></p><p class="c5"><span class="c0">&nbsp; // - The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c0">&nbsp; // For LISTPICKER_COMPONENT_VERSION 3:</span></p><p class="c5"><span class="c0">&nbsp; // - The SelectionIndex read-write property was added.</span></p><p class="c5"><span class="c0">&nbsp; // For LISTPICKER_COMPONENT_VERSION 4:</span></p><p class="c5"><span class="c0">&nbsp; // - The method Open was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; // For LISTPICKER_COMPONENT_VERSION 5:</span></p><p class="c5"><span class="c0 c12">&nbsp; // - The Shape property was added.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">public static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">LISTPICKER_COMPONENT_VERSION</span><span class="c1">&nbsp;= </span><span class="c1 c12">5</span><span class="c11 c1">;</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c0">// For PHONENUMBERPICKER_COMPONENT_VERSION 2:</span></p><p class="c5"><span class="c0">&nbsp; // - The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c0">&nbsp; // For PHONENUMBERPICKER_COMPONENT_VERSION 3:</span></p><p class="c5"><span class="c0">&nbsp; // - The method Open was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; // For PHONENUMBERPICKER_COMPONENT_VERSION 4:</span></p><p class="c5"><span class="c0 c12">&nbsp; // - The Shape property was added.</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">public static final int</span><span class="c1">&nbsp;</span><span class="c1 c6">PHONENUMBERPICKER_COMPONENT_VERSION</span><span class="c1">&nbsp;= </span><span class="c1 c12">4</span><span class="c11 c1">;</span></p><p class="c32"><span class="c22">Figure 16: Addition to YaVersion Class</span></p><h3 class="c40" id="h.si39bcfsv8bl"><span class="c11 c38">4.2 YoungAndroidFormUpgrader</span></h3><p class="c5"><span>As stated in the instructions in YaVersion, if a component version is updated code must be added to the </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/com/google/appinventor/client/youngandroid/YoungAndroidFormUpgrader.html&amp;sa=D&amp;ust=1539767126922000">YoungAndroidFormUpgrade</a></span><span>&nbsp;(in com.google.appinventor.client.youngandroid)</span><span class="c11 c16">. &nbsp;For the Button Shape example the following gray code needs to be added to the YoungAndroidFormUpgrader class.</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private static int</span><span class="c11 c1">&nbsp;upgradeButtonProperties(Map&lt;String, JSONValue&gt; componentProperties,</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c2">int</span><span class="c11 c1">&nbsp;srcCompVersion) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; handlePropertyRename(componentProperties, </span><span class="c1 c6">"Alignment"</span><span class="c1">, </span><span class="c1 c6">"TextAlignment"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Properties related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The LongClick event was added.</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; // No properties need to be modified to upgrade to version 3.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if</span><span class="c11 c1 c12">&nbsp;(srcCompVersion &lt; 4) {</span></p><p class="c5"><span class="c1 c12">&nbsp; &nbsp; </span><span class="c0 c12">// The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No properties need to be modified to upgrade to version 4.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; srcCompVersion = 4;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;srcCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private static int </span><span class="c11 c1">upgradeContactPickerProperties(Map&lt;String, JSONValue&gt; &nbsp;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; componentProperties, </span><span class="c2">int</span><span class="c11 c1">&nbsp;srcCompVersion) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; handlePropertyRename(componentProperties, </span><span class="c1 c6">"Alignment"</span><span class="c1">, </span><span class="c1 c6">"TextAlignment"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Properties related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Open method was added. &nbsp;No changes are needed.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if</span><span class="c11 c1 c12">&nbsp;(srcCompVersion &lt; 4) {</span></p><p class="c5"><span class="c1 c12">&nbsp; &nbsp; </span><span class="c0 c12">// The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No properties need to be modified to upgrade to version 4.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; srcCompVersion = 4;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;srcCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private static int</span><span class="c11 c1">&nbsp;upgradeImagePickerProperties(Map&lt;String, JSONValue&gt; &nbsp;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; componentProperties, </span><span class="c2">int</span><span class="c11 c1">&nbsp;srcCompVersion) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; handlePropertyRename(componentProperties, </span><span class="c1 c6">"Alignment"</span><span class="c1">, </span><span class="c1 c6">"TextAlignment"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Properties related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Open method was added. &nbsp;No changes are needed.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if</span><span class="c11 c1 c12">&nbsp;(srcCompVersion &lt; 4) {</span></p><p class="c5"><span class="c1 c12">&nbsp; &nbsp; </span><span class="c0 c12">// The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No properties need to be modified to upgrade to version 4.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; srcCompVersion = 4;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;srcCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private static int</span><span class="c11 c1">&nbsp;upgradeListPickerProperties(Map&lt;String, JSONValue&gt; &nbsp;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; componentProperties, </span><span class="c2">int</span><span class="c11 c1">&nbsp;srcCompVersion) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; handlePropertyRename(componentProperties, </span><span class="c1 c6">"Alignment"</span><span class="c1">, </span><span class="c1 c6">"TextAlignment"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Properties related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The SelectionIndex property was added. &nbsp;No changes are needed.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 4) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c0">&nbsp; // The Open method was added. &nbsp;No changes are needed.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 4;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if</span><span class="c11 c1 c12">&nbsp;(srcCompVersion &lt; 5) {</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No properties need to be modified to upgrade to version 5.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; srcCompVersion = 5;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;srcCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private static int</span><span class="c11 c1">&nbsp;upgradePhoneNumberPickerProperties(Map&lt;String, JSONValue&gt; &nbsp;</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; componentProperties, </span><span class="c2">int</span><span class="c11 c1">&nbsp;srcCompVersion) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 2) {</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; // The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; handlePropertyRename(componentProperties, </span><span class="c1 c6">"Alignment"</span><span class="c1">, </span><span class="c1 c6">"TextAlignment"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp;</span><span class="c0">&nbsp;// Properties related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(srcCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp;</span><span class="c0">&nbsp; &nbsp;// The Open method was added. &nbsp;No changes are needed.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; srcCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if</span><span class="c11 c1 c12">&nbsp;(srcCompVersion &lt; 4) {</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No properties need to be modified to upgrade to version 4.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; srcCompVersion = 4;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return </span><span class="c11 c1">srcCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c32"><span class="c22">Figure 17: Addition to YoungAndroidFormUpgrader Class</span></p><h3 class="c40" id="h.psfo74spnt8y"><span class="c11 c38">4.3 BlockSaveFile<br></span></h3><p class="c5"><span>The </span><span class="c25"><a class="c7" href="https://www.google.com/url?q=http://javadoc.app-inventor-releases.googlecode.com/hg/openblocks/yacodeblocks/BlockSaveFile.html&amp;sa=D&amp;ust=1539767126934000">BlockSaveFile</a></span><span>&nbsp;class (in openblocks.yacodeblocks) must also be updated</span><span>.</span><span>&nbsp;</span><span>&nbsp;</span><span class="c11 c16">If any component version numbers were increased then add code to upgradeComponentBlocks(). &nbsp;</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span>Add the following gray code to upgradeComponentBlocks() for the Button Shape example.</span></p><p class="c3"><span class="c11 c16"></span></p><p class="c5"><span class="c2">private int</span><span class="c1">&nbsp;upgradeButtonBlocks(</span><span class="c2">int</span><span class="c11 c1">&nbsp;blkCompVersion, String componentName) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c1 c26">// The Alignment property was renamed to TextAlignment</span><span class="c0">.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; handlePropertyRename(componentName, </span><span class="c1 c6">"Alignment"</span><span class="c1">, </span><span class="c1 c6">"TextAlignment"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Blocks related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 3) {</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; // The LongClick event was added.</span></p><p class="c5"><span class="c0">&nbsp; &nbsp; // No blocks need to be modified to upgrade to version 3.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if</span><span class="c11 c1 c12">&nbsp;(blkCompVersion &lt; 4) {</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No blocks need to be modified to upgrade to version 4.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; blkCompVersion = 4;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;blkCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private int </span><span class="c1">upgradeContactPickerBlocks(</span><span class="c2">int</span><span class="c11 c1">&nbsp;blkCompVersion, String componentName) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; handlePropertyRename(componentName, "Alignment", "TextAlignment");</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Blocks related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Open method was added, which does not require changes.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if </span><span class="c11 c1 c12">(blkCompVersion &lt; 4) {</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No blocks need to be modified to upgrade to version 4.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; blkCompVersion = 4;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;blkCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private int</span><span class="c1">&nbsp;upgradeImagePickerBlocks(</span><span class="c2">int</span><span class="c11 c1">&nbsp;blkCompVersion, String componentName) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; handlePropertyRename(componentName, </span><span class="c1 c6">"Alignment"</span><span class="c1">, </span><span class="c1 c6">"TextAlignment"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Blocks related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if </span><span class="c11 c1">(blkCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Open method was added, which does not require changes.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if </span><span class="c11 c1 c12">(blkCompVersion &lt; 4) {</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No blocks need to be modified to upgrade to version 4.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; blkCompVersion = 4;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;blkCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private int</span><span class="c1">&nbsp;upgradeListPickerBlocks(</span><span class="c2">int</span><span class="c11 c1">&nbsp;blkCompVersion, String componentName) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; handlePropertyRename(componentName, </span><span class="c1 c6">"Alignment"</span><span class="c1">, </span><span class="c1 c6">"TextAlignment"</span><span class="c11 c1">);</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Blocks related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The SelectionIndex property was added, which does not require changes.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 4) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Open method was added, which does not require changes.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 4;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if</span><span class="c11 c1 c12">&nbsp;(blkCompVersion &lt; 5) {</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No blocks need to be modified to upgrade to version 5.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; blkCompVersion = 5;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;blkCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c3"><span class="c11 c1"></span></p><p class="c5"><span class="c2">private int</span><span class="c1">&nbsp;upgradePhoneNumberPickerBlocks(</span><span class="c2">int</span><span class="c11 c1">&nbsp;blkCompVersion, String componentName) {</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 2) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Alignment property was renamed to TextAlignment.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; handlePropertyRename(componentName, "Alignment", "TextAlignment");</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// Blocks related to this component have now been upgraded to version 2.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 2;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">if</span><span class="c11 c1">&nbsp;(blkCompVersion &lt; 3) {</span></p><p class="c5"><span class="c1">&nbsp; &nbsp; </span><span class="c0">// The Open method was added, which does not require changes.</span></p><p class="c5"><span class="c11 c1">&nbsp; &nbsp; blkCompVersion = 3;</span></p><p class="c5"><span class="c11 c1">&nbsp; }</span></p><p class="c5"><span class="c1 c12">&nbsp; </span><span class="c2 c12">if</span><span class="c11 c1 c12">&nbsp;(blkCompVersion &lt; 4) {</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // The Shape property was added.</span></p><p class="c5"><span class="c0 c12">&nbsp; &nbsp; // No blocks need to be modified to upgrade to version 4.</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; &nbsp; blkCompVersion = 4;</span></p><p class="c5"><span class="c11 c1 c12">&nbsp; }</span></p><p class="c5"><span class="c1">&nbsp; </span><span class="c2">return</span><span class="c11 c1">&nbsp;blkCompVersion;</span></p><p class="c5"><span class="c11 c1">}</span></p><p class="c32"><span class="c22">Figure 18: Addition to BlockSaveFile </span><span class="c22">Class</span></p><p class="c31"><span class="c11 c16"></span></p><h2 class="c21" id="h.vsfxd7ls6pw7"><span class="c11 c24">5. Deprecating methods and events and properties</span></h2><p class="c5 c20"><span class="c11 c16">Sometimes, in ongoing development, it’s necessary to deprecate an existing event, method or property. &nbsp; This removes the element from the blocks palette and drawer. &nbsp;If an existing project that contains the block is read in, the block will be outlined in red and made inactive, indicating that the user should remove it.</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c5 c20"><span class="c11 c16">To deprecate a block add the @Deprecated annotation to the component java file. &nbsp; In addition, if this is a designer property, comment out the @Designerproperty annotation. &nbsp; For example, here’s how we deprecated the Camera.useFront property (both the getter and the setter):</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c5 c20"><span class="c11 c1">&nbsp;/**</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;* Returns true if the front-facing camera is to be used (when available)</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;*</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;* @return {@code true} indicates front-facing to be used, {@code false} by default</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;*/</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; @Deprecated</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; @SimpleProperty(category = PropertyCategory.BEHAVIOR)</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; public boolean UseFront() {</span></p><p class="c5 c20"><span class="c11 c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return useFront;</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; }</span></p><p class="c3 c20"><span class="c11 c1"></span></p><p class="c5 c20"><span class="c11 c1">&nbsp; /**</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;* Specifies whether the front-facing camera should be used (when available)</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;*</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;* @param front</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;* &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code true} for front-facing camera, {@code false} for default</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; &nbsp;*/</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; @Deprecated</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; // Hide the deprecated property from the Designer</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; // &nbsp;@DesignerProperty(editorType = PropertyTypeConstants.PROPERTY_TYPE_BOOLEAN, defaultValue = "False")</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; @SimpleProperty(description = "Specifies whether the front-facing camera should be used (when available). "</span></p><p class="c5 c20"><span class="c11 c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ "If the device does not have a front-facing camera, this option will be ignored "</span></p><p class="c5 c20"><span class="c11 c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ "and the camera will open normally.")</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; public void UseFront(boolean front) {</span></p><p class="c5 c20"><span class="c11 c1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;useFront = front;</span></p><p class="c5 c20"><span class="c11 c1">&nbsp; }</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c5 c20"><span class="c11 c16">Also update versioning.js to record that the deprecation was done -- although “no upgrade was necessary”. &nbsp; Here’s how that was done in for Camera.useFront for version 3 of the Camera component.</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c5 c20"><span class="c11 c16">&nbsp; "Camera": {</span></p><p class="c5 c20"><span class="c11 c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c5 c20"><span class="c11 c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// AI2: The UseFront property was removed</span></p><p class="c5 c20"><span class="c11 c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3: "noUpgrade"</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c5 c20"><span class="c11 c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c5 c20"><span class="c11 c16">&nbsp; }, // End Camera upgraders</span></p><p class="c3 c20"><span class="c11 c16"></span></p><h2 class="c21" id="h.ek4afml69u22"><span class="c11 c24">6. Internationalization</span></h2><p class="c37 c20"><span class="c11 c16">Names of methods and events and properties need to internationalized so that they can appear in several languages. &nbsp;Don’t use hard-coded strings for these names. &nbsp;Instead, add variables in OdeMessages.java. &nbsp;Similarly for component descriptions.</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c20 c37"><span class="c11 c16">Add an entry for each new property/event/method into OdeMessages.java iff a property with that name doesn't already exist (so if you are adding a property that has the same name as another property in a different component, (even in a different language) &nbsp;you don't do it a second time). For example, to add the "Foo" property you would add:</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c37 c20"><span class="c11 c16">@defaultMessage("Foo")</span></p><p class="c37 c20"><span class="c11 c16">@description("This the name of the wonderful Foo property")</span></p><p class="c37 c20"><span class="c11 c16">String FooProperties();</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c37 c20"><span class="c11 c16">The localized strings for the different languages are in the /appengine/src/com/google/appinventor/client.OdeMessages&lt;language&gt;.properties files. &nbsp;The system is designed so that if there is no translation, then English will be used. &nbsp;So you don’t need to supply translations when you implement the properties; these can be added later.</span></p><p class="c3 c20"><span class="c11 c16"></span></p><p class="c37 c20"><span class="c11 c16">If you edit the description of a component (but not yet a</span></p><p class="c37 c20"><span class="c11 c16">property,method or event of that component) you must also find and</span></p><p class="c5 c20"><span>update the description in OdeMessages.java</span></p><p class="c3"><span class="c11 c16"></span></p></div><div id="footer"><span>Published by <a target="_blank" title="Learn more about Google Drive" href="https://docs.google.com/">Google Drive</a></span><span class="dash">–</span><a href="https://docs.google.com/abuse?id=1ukpZXcd0fIn1fV0cNp4J00wrfwwA1daswU1yY6dqqfs">Report Abuse</a><span class="dash">–</span><span>Updated automatically every 5 minutes</span></div><script type="text/javascript">(function(){Object.defineProperty(e,"rwt",{value:function(){return!0},writable:!1,configurable:!1})})();</script><script type="text/javascript" nonce="">(function(){var aa="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,ba="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ca;if("function"==typeof Object.setPrototypeOf)ca=Object.setPrototypeOf;else{var ea;a:{var fa={s:!0},ha={};try{ha.__proto__=fa;ea=ha.s;break a}catch(a){}ea=!1}ca=ea?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ia=ca;
function k(a,b){a.prototype=ba(b.prototype);a.prototype.constructor=a;if(ia)ia(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.j=b.prototype}function ja(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ka="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
function la(a){if(a){for(var b=aa,c=["WeakMap"],d=0;d<c.length-1;d++){var e=c[d];e in b||(b[e]={});b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&ka(b,c,{configurable:!0,writable:!0,value:a})}}function m(a,b){return Object.prototype.hasOwnProperty.call(a,b)}
la(function(a){function b(a){this.a=(g+=Math.random()+1).toString();if(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];for(a=b?b.call(a):{next:ja(a)};!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}}function c(){}function d(a){m(a,f)||ka(a,f,{value:new c})}function e(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof c)return a;d(a);return b(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=
d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(da){return!1}}())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0;b.prototype.set=function(a,b){d(a);if(!m(a,f))throw Error("WeakMap key fail: "+a);a[f][this.a]=b;return this};b.prototype.get=function(a){return m(a,f)?a[f][this.a]:void 0};b.prototype.has=function(a){return m(a,f)&&m(a[f],this.a)};b.prototype.delete=function(a){return m(a,f)&&m(a[f],this.a)?delete a[f][this.a]:
!1};return b});var n=this;function ma(){}
function p(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function na(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function oa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}
function pa(a,b){function c(){}c.prototype=b.prototype;a.j=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.w=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}};function qa(a){qa[" "](a);return a}qa[" "]=ma;function ra(a,b,c){return Object.prototype.hasOwnProperty.call(a,b)?a[b]:a[b]=c(b)};function sa(a){return ra(a.prototype,"$$generatedClassName",function(){return"Class$obf_"+{valueOf:function(){return++ta}}})}var ta=1E3;function q(){}q.prototype.g=function(){return ua(this)};q.prototype.toString=function(){return t(u(v(this.constructor)))+"@"+t((this.g()>>>0).toString(16))};function w(){this.a=!1}k(w,q);w.prototype.f=function(a){return Error(a)};function va(a,b){a.b=b;if(null!=b)try{b.o=a}catch(c){}}function wa(a){if(a.a&&"__noinit__"!==a.b){var b=null==a.c?null:a.c.replace(/\n/g,"\u200b\n");b=xa(a,b);b=a.f(b);if(!("stack"in b))try{throw b;}catch(c){}va(a,b)}}w.prototype.toString=function(){return xa(this,this.c)};function xa(a,b){a=u(v(a.constructor));return null==b?a:t(a)+": "+t(b)};function ya(){this.a=!1}k(ya,w);function za(){this.a=!1}k(za,ya);function ua(a){return a.l||(Object.defineProperties(a,{l:{value:++Aa,enumerable:!1}}),a.l)}var Aa=0;function Ba(){this.a=!1}k(Ba,za);function Ca(){this.a=!1}k(Ca,Ba);Ca.prototype.f=function(a){return new TypeError(a)};function Da(a,b){return"string"==typeof a?a.charCodeAt(b):a.C(b)};function t(a){if(null==a)a="null";else if(a instanceof Array){var b=a.v;a=u(b?v(b.B,b.A):v(q,1))+"@"+(ua(a)>>>0).toString(16)}else a=a.toString();return a}function Ea(a){if(65536<=a){var b=56320+(a-65536&1023)&65535;return t(String.fromCharCode(55296+(a-65536>>10&1023)&65535))+t(String.fromCharCode(b))}return String.fromCharCode(a&65535)}
function Fa(a,b){var c=b,d=a.length;b=Da(a,c++);var e;if(d=55296<=b&&56319>=b&&c<d)a=e=Da(a,c),d=56320<=a&&57343>=a;var f;d?f=65536+((b&1023)<<10)+(e&1023):f=b;return f}function Ga(a,b){return a===b||null==a&&null==b};function Ha(a,b){this.b=a;this.a=b}k(Ha,q);function u(a){var b=sa(a.b);0!=a.a&&(b="L"+t(b)+";");a=a.a;for(var c="",d=0;d<a;d++)c=t(c)+"[";return t(c)+t(b)}Ha.prototype.toString=function(){return"class "+t(u(this))};function v(a,b){var c=b||0;return ra(a.prototype,"$$class/"+c,function(){return new Ha(a,c)})};function Ia(a,b){return null==a?a:b?decodeURI(a):decodeURIComponent(a)};var Ja=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\S\s]*))?$/;function Ka(a){a=Ja.exec(a);for(var b=[],c=0;7>=c;c++)a.length<=c||null==a[c]?b.push(null):b.push(a[c]);return b}
function La(a,b){var c=Ea(35);c=a.indexOf(c);c=0>c?a.length:c;a:{var d=0;for(var e=b.length;0<(d=a.indexOf(b,d))&&d<c;){var f=Fa(a,d-1);if(38==f||63==f){if(d+e>=a.length)break a;f=Fa(a,d+e);if(61==f||38==f||35==f)break a}d+=e+1}d=-1}if(0>d)return null;e=d;f=Ea(38);e=a.indexOf(f,e);if(0>e||e>c)e=c;d+=b.length+1;b=Math.min(a.length,d);a=a.substr(b,Math.min(a.length,Math.max(d,e))-b);c=" ";for(b=0;0<=(b=c.indexOf("\\",b));)36==c.charCodeAt(b+1)?(d=t(c.substr(0,b))+"$",e=++b,c=d+t(c.substr(e))):(d=t(c.substr(0,
b)),e=++b,c=d+t(c.substr(e)));a=a.replace(/\+/g,c);return Ia(a,!1)};var Ma=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]},Na=/&/g,Oa=/</g,Pa=/>/g,Qa=/"/g,Ra=/'/g,Sa=/\x00/g,Ta=/[\x00&<>"']/;function Ua(a,b){return a<b?-1:a>b?1:0};var Va=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"==typeof a)return"string"==typeof b&&1==b.length?a.indexOf(b,0):-1;for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};function y(a,b){this.a=[];this.b=b;for(var c=!0,d=a.length-1;0<=d;d--){var e=a[d]|0;c&&e==b||(this.a[d]=e,c=!1)}}var Wa={};function z(a){if(-128<=a&&128>a){var b=Wa[a];if(b)return b}b=new y([a|0],0>a?-1:0);-128<=a&&128>a&&(Wa[a]=b);return b}function A(a){if(isNaN(a)||!isFinite(a))return B;if(0>a)return C(A(-a));for(var b=[],c=1,d=0;a>=c;d++)b[d]=a/c|0,c*=4294967296;return new y(b,0)}var B=z(0),D=z(1),Xa=z(16777216);
function E(a){if(-1==a.b)return-E(C(a));for(var b=0,c=1,d=0;d<a.a.length;d++){var e=F(a,d);b+=(0<=e?e:4294967296+e)*c;c*=4294967296}return b}y.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(G(this))return"0";if(-1==this.b)return"-"+C(this).toString(a);for(var b=A(Math.pow(a,6)),c=this,d="";;){var e=H(c,b);c=I(c,J(e,b));var f=((0<c.a.length?c.a[0]:c.b)>>>0).toString(a);c=e;if(G(c))return f+d;for(;6>f.length;)f="0"+f;d=f+d}};
function F(a,b){return 0>b?0:b<a.a.length?a.a[b]:a.b}function G(a){if(0!=a.b)return!1;for(var b=0;b<a.a.length;b++)if(0!=a.a[b])return!1;return!0}function K(a,b){a=I(a,b);return-1==a.b?-1:G(a)?0:1}function C(a){for(var b=a.a.length,c=[],d=0;d<b;d++)c[d]=~a.a[d];return(new y(c,~a.b)).add(D)}
y.prototype.add=function(a){for(var b=Math.max(this.a.length,a.a.length),c=[],d=0,e=0;e<=b;e++){var f=d+(F(this,e)&65535)+(F(a,e)&65535),g=(f>>>16)+(F(this,e)>>>16)+(F(a,e)>>>16);d=g>>>16;f&=65535;g&=65535;c[e]=g<<16|f}return new y(c,c[c.length-1]&-2147483648?-1:0)};function I(a,b){return a.add(C(b))}
function J(a,b){if(G(a)||G(b))return B;if(-1==a.b)return-1==b.b?J(C(a),C(b)):C(J(C(a),b));if(-1==b.b)return C(J(a,C(b)));if(0>K(a,Xa)&&0>K(b,Xa))return A(E(a)*E(b));for(var c=a.a.length+b.a.length,d=[],e=0;e<2*c;e++)d[e]=0;for(e=0;e<a.a.length;e++)for(var f=0;f<b.a.length;f++){var g=F(a,e)>>>16,h=F(a,e)&65535,l=F(b,f)>>>16,r=F(b,f)&65535;d[2*e+2*f]+=h*r;L(d,2*e+2*f);d[2*e+2*f+1]+=g*r;L(d,2*e+2*f+1);d[2*e+2*f+1]+=h*l;L(d,2*e+2*f+1);d[2*e+2*f+2]+=g*l;L(d,2*e+2*f+2)}for(e=0;e<c;e++)d[e]=d[2*e+1]<<16|
d[2*e];for(e=c;e<2*c;e++)d[e]=0;return new y(d,0)}function L(a,b){for(;(a[b]&65535)!=a[b];)a[b+1]+=a[b]>>>16,a[b]&=65535,b++}
function H(a,b){if(G(b))throw Error("division by zero");if(G(a))return B;if(-1==a.b)return-1==b.b?H(C(a),C(b)):C(H(C(a),b));if(-1==b.b)return C(H(a,C(b)));if(30<a.a.length){if(-1==a.b||-1==b.b)throw Error("slowDivide_ only works with positive integers.");for(var c=D;0>=K(b,a);)c=Ya(c,1),b=Ya(b,1);var d=M(c,1),e=M(b,1);b=M(b,2);for(c=M(c,2);!G(b);){var f=e.add(b);0>=K(f,a)&&(d=d.add(c),e=f);b=M(b,1);c=M(c,1)}return d}for(c=B;0<=K(a,b);){d=Math.max(1,Math.floor(E(a)/E(b)));e=Math.ceil(Math.log(d)/Math.LN2);
e=48>=e?1:Math.pow(2,e-48);f=A(d);for(var g=J(f,b);-1==g.b||0<K(g,a);)d-=e,f=A(d),g=J(f,b);G(f)&&(f=D);c=c.add(f);a=I(a,g)}return c}y.prototype.and=function(a){for(var b=Math.max(this.a.length,a.a.length),c=[],d=0;d<b;d++)c[d]=F(this,d)&F(a,d);return new y(c,this.b&a.b)};y.prototype.or=function(a){for(var b=Math.max(this.a.length,a.a.length),c=[],d=0;d<b;d++)c[d]=F(this,d)|F(a,d);return new y(c,this.b|a.b)};
y.prototype.xor=function(a){for(var b=Math.max(this.a.length,a.a.length),c=[],d=0;d<b;d++)c[d]=F(this,d)^F(a,d);return new y(c,this.b^a.b)};function Ya(a,b){var c=b>>5;b%=32;for(var d=a.a.length+c+(0<b?1:0),e=[],f=0;f<d;f++)e[f]=0<b?F(a,f-c)<<b|F(a,f-c-1)>>>32-b:F(a,f-c);return new y(e,a.b)}function M(a,b){var c=b>>5;b%=32;for(var d=a.a.length-c,e=[],f=0;f<d;f++)e[f]=0<b?F(a,f+c)>>>b|F(a,f+c+1)<<32-b:F(a,f+c);return new y(e,a.b)};function Za(a,b,c){for(var d in a)b.call(c,a[d],d,a)};I(Ya(D,32),D);z(65535);I(Ya(D,128),D);var N;a:{var $a=n.navigator;if($a){var ab=$a.userAgent;if(ab){N=ab;break a}}N=""}function O(a){return-1!=N.indexOf(a)};var bb=O("Opera"),P=O("Trident")||O("MSIE"),cb=O("Edge"),db=cb||P,eb=O("Gecko")&&!(-1!=N.toLowerCase().indexOf("webkit")&&!O("Edge"))&&!(O("Trident")||O("MSIE"))&&!O("Edge"),fb=-1!=N.toLowerCase().indexOf("webkit")&&!O("Edge"),gb=O("Macintosh");function hb(){var a=n.document;return a?a.documentMode:void 0}var ib;
a:{var jb="",kb=function(){var a=N;if(eb)return/rv:([^\);]+)(\)|;)/.exec(a);if(cb)return/Edge\/([\d\.]+)/.exec(a);if(P)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(fb)return/WebKit\/(\S+)/.exec(a);if(bb)return/(?:Version)[ \/]?(\S+)/.exec(a)}();kb&&(jb=kb?kb[1]:"");if(P){var lb=hb();if(null!=lb&&lb>parseFloat(jb)){ib=String(lb);break a}}ib=jb}var mb=ib,nb={},ob;var pb=n.document;ob=pb&&P?hb()||("CSS1Compat"==pb.compatMode?parseInt(mb,10):5):void 0;function S(){this.b=this.b;this.a=this.a}S.prototype.b=!1;S.prototype.m=function(){this.b||(this.b=!0,this.f())};S.prototype.f=function(){if(this.a)for(;this.a.length;)this.a.shift()()};function qb(a){a&&"function"==typeof a.m&&a.m()};function T(){this.b="";this.f=rb}T.prototype.c=!0;T.prototype.a=function(){return this.b};function sb(a){if(a instanceof T&&a.constructor===T&&a.f===rb)return a.b;p(a);return"type_error:SafeUrl"}var tb=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,rb={};function ub(a){var b=new T;b.b=a;return b};function U(){this.b="";this.f=vb}U.prototype.c=!0;U.prototype.a=function(){return this.b};function wb(a){if(a instanceof U&&a.constructor===U&&a.f===vb)return a.b;p(a);return"type_error:SafeHtml"}var vb={};var xb=!P||9<=Number(ob),yb=!P||9<=Number(ob),zb=P&&!ra(nb,"9",function(){for(var a=0,b=Ma(String(mb)).split("."),c=Ma("9").split("."),d=Math.max(b.length,c.length),e=0;0==a&&e<d;e++){var f=b[e]||"",g=c[e]||"";do{f=/(\d*)(\D*)(.*)/.exec(f)||["","","",""];g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];if(0==f[0].length&&0==g[0].length)break;a=Ua(0==f[1].length?0:parseInt(f[1],10),0==g[1].length?0:parseInt(g[1],10))||Ua(0==f[2].length,0==g[2].length)||Ua(f[2],g[2]);f=f[3];g=g[3]}while(0==a)}return 0<=a}),
Ab=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{n.addEventListener("test",ma,b),n.removeEventListener("test",ma,b)}catch(c){}return a}();function Bb(a,b){this.type=a;this.a=this.target=b;this.f=!1}Bb.prototype.c=function(){this.f=!0};function V(a,b){Bb.call(this,a?a.type:"");this.relatedTarget=this.a=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.a=b;if(b=a.relatedTarget){if(eb){a:{try{qa(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else"mouseover"==c?b=
a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;null===d?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=
a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"==typeof a.pointerType?a.pointerType:Cb[a.pointerType]||"";this.b=a;a.defaultPrevented&&this.c()}}pa(V,Bb);var Db=[1,4,2],Cb={2:"touch",3:"pen",4:"mouse"};V.prototype.c=function(){V.j.c.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,zb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Eb="closure_listenable_"+(1E6*Math.random()|0),Fb=0;function Gb(a,b,c,d,e){this.listener=a;this.a=null;this.src=b;this.type=c;this.capture=!!d;this.b=e;this.key=++Fb;this.h=this.i=!1}function Hb(a){a.h=!0;a.listener=null;a.a=null;a.src=null;a.b=null};function Ib(a){this.src=a;this.a={};this.b=0}Ib.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g;a:{for(g=0;g<a.length;++g){var h=a[g];if(!h.h&&h.listener==b&&h.capture==!!d&&h.b==e)break a}g=-1}-1<g?(b=a[g],c||(b.i=!1)):(b=new Gb(b,this.src,f,!!d,e),b.i=c,a.push(b));return b};var Jb="closure_lm_"+(1E6*Math.random()|0),Kb={},Lb=0;function Mb(a,b,c,d,e){if(d&&d.once)return Nb(a,b,c,d,e);if("array"==p(b)){for(var f=0;f<b.length;f++)Mb(a,b[f],c,d,e);return null}c=Ob(c);return a&&a[Eb]?a.a(b,c,na(d)?!!d.capture:!!d,e):Pb(a,b,c,!1,d,e)}
function Pb(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=na(e)?!!e.capture:!!e,h=Qb(a);h||(a[Jb]=h=new Ib(a));c=h.add(b,c,d,g,f);if(c.a)return c;d=Rb();c.a=d;d.src=a;d.listener=c;if(a.addEventListener)Ab||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(Sb(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");Lb++;return c}
function Rb(){var a=Tb,b=yb?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function Nb(a,b,c,d,e){if("array"==p(b)){for(var f=0;f<b.length;f++)Nb(a,b[f],c,d,e);return null}c=Ob(c);return a&&a[Eb]?a.b(b,c,na(d)?!!d.capture:!!d,e):Pb(a,b,c,!0,d,e)}
function Ub(a){if("number"!=typeof a&&a&&!a.h){var b=a.src;if(b&&b[Eb])b.c(a);else{var c=a.type,d=a.a;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(Sb(c),d):b.addListener&&b.removeListener&&b.removeListener(d);Lb--;if(c=Qb(b)){d=a.type;if(d in c.a){var e=c.a[d],f=Va(e,a),g;(g=0<=f)&&Array.prototype.splice.call(e,f,1);g&&(Hb(a),0==c.a[d].length&&(delete c.a[d],c.b--))}0==c.b&&(c.src=null,b[Jb]=null)}else Hb(a)}}}
function Sb(a){return a in Kb?Kb[a]:Kb[a]="on"+a}function Vb(a,b,c,d){var e=!0;if(a=Qb(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.h&&(f=Wb(f,d),e=e&&!1!==f)}return e}function Wb(a,b){var c=a.listener,d=a.b||a.src;a.i&&Ub(a);return c.call(d,b)}
function Tb(a,b){if(a.h)return!0;if(!yb){if(!b)a:{b=["window","event"];for(var c=n,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new V(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.a;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;0<=e;e--){b.a=d[e];var f=Vb(d[e],a,!0,b);c=c&&f}for(e=0;e<d.length;e++)b.a=d[e],f=Vb(d[e],a,!1,b),c=c&&f}return c}return Wb(a,
new V(b,this))}function Qb(a){a=a[Jb];return a instanceof Ib?a:null}var Xb="__closure_events_fn_"+(1E9*Math.random()>>>0);function Ob(a){if("function"==p(a))return a;a[Xb]||(a[Xb]=function(b){return a.handleEvent(b)});return a[Xb]};function W(a){S.call(this);this.g=a;this.c={}}pa(W,S);var Yb=[];function Zb(a){Za(a.c,function(a,c){this.c.hasOwnProperty(c)&&Ub(a)},a);a.c={}}W.prototype.f=function(){W.j.f.call(this);Zb(this)};W.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function $b(a){S.call(this);this.c=a||document.body;this.g=new W(this);a=oa(qb,this.g);this.b?a():(this.a||(this.a=[]),this.a.push(a));a=this.g;var b=this.c,c=this.u,d="click";"array"!=p(d)&&(d&&(Yb[0]=d.toString()),d=Yb);for(var e=0;e<d.length;e++){var f=Mb(b,d[e],c||a.handleEvent,!1,a.g||a);if(!f)break;a.c[f.key]=f}}pa($b,S);
$b.prototype.u=function(a){if((xb?0==a.b.button:"click"==a.type||a.b.button&Db[0])&&!(fb&&gb&&a.ctrlKey)&&!a.f)for(var b=a.target;b&&b!=this.c;){if(b.tagName&&"a"==b.tagName.toLowerCase()){var c=b.getAttribute("href")||b.getAttributeNS("http://www.w3.org/1999/xlink","href"),d=c;var e=d;try{var f=void 0,g=Ka(d)[3];f=null==g?null:g;var h=Ia(f,!0);var l;if(l=Ga("www.google.com",h)){var r=Ka(d)[5];l=Ga("/url",Ia(r,!0))}if(l){var da=La(d,"q");e=da?da:La(d,"url")}}catch(Q){a:{d=Q;if(null!=d&&(f=d.o,null!=
f)){Q=f;break a}if(d instanceof TypeError){var x=f=new Ca,R=x;R.a=!0;R.b="__noinit__";wa(x);va(x,d);x.c=t(d);d=f}else R=x=f=new Ba,R.a=!0,R.b="__noinit__",wa(x),va(x,d),x.c=t(d),d=f;Q=d}if(!(Q instanceof ya))throw Q.b;}e=null!=e?e:"";if(c!=e){l=void 0;g=e;b={target:"_blank",noreferrer:!0};c=window;g instanceof T?h=g:(h="undefined"!=typeof g.href?g.href:String(g),h instanceof T||(h="object"==typeof h&&h.c?h.a():String(h),tb.test(h)||(h="about:invalid#zClosurez"),h=ub(h)));g=b.target||g.target;r=[];
for(l in b)switch(l){case "width":case "height":case "top":case "left":r.push(l+"="+b[l]);break;case "target":case "noopener":case "noreferrer":break;default:r.push(l+"="+(b[l]?1:0))}l=r.join(",");(O("iPhone")&&!O("iPod")&&!O("iPad")||O("iPad")||O("iPod"))&&c.navigator&&c.navigator.standalone&&g&&"_self"!=g?(r=l=c.document.createElement("A"),h instanceof T||h instanceof T||(h="object"==typeof h&&h.c?h.a():String(h),tb.test(h)||(h="about:invalid#zClosurez"),h=ub(h)),r.href=sb(h),l.setAttribute("target",
g),b.noreferrer&&l.setAttribute("rel","noreferrer"),b=document.createEvent("MouseEvent"),b.initMouseEvent("click",!0,!0,c,1),l.dispatchEvent(b)):b.noreferrer?(c=c.open("",g,l),b=sb(h),c&&(db&&-1!=b.indexOf(";")&&(b="'"+b.replace(/'/g,"%27")+"'"),c.opener=null,Ta.test(b)&&(-1!=b.indexOf("&")&&(b=b.replace(Na,"&amp;")),-1!=b.indexOf("<")&&(b=b.replace(Oa,"&lt;")),-1!=b.indexOf(">")&&(b=b.replace(Pa,"&gt;")),-1!=b.indexOf('"')&&(b=b.replace(Qa,"&quot;")),-1!=b.indexOf("'")&&(b=b.replace(Ra,"&#39;")),
-1!=b.indexOf("\x00")&&(b=b.replace(Sa,"&#0;"))),h=new U,h.b='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+b+'">',c.document.write(wb(h)),c.document.close())):(c=c.open(sb(h),g,l))&&b.noopener&&(c.opener=null);a.c();break}}b=b.parentNode}};function ac(a){new $b(a)}var X=["DOCS_installLinkReferrerSanitizer"],Y=n;X[0]in Y||"undefined"==typeof Y.execScript||Y.execScript("var "+X[0]);
for(var Z;X.length&&(Z=X.shift());)X.length||void 0===ac?Y[Z]&&Y[Z]!==Object.prototype[Z]?Y=Y[Z]:Y=Y[Z]={}:Y[Z]=ac;}).call(this);
</script><script type="text/javascript" nonce="">DOCS_installLinkReferrerSanitizer();</script><div id="Vidown_extension_alhnopeoagjmjfgcbnokcnagkecgdcdh" style="display: none;"></div><div id="vidown_float_panel_div" style="display: none;"><a id="vidown_float_panel_download" title="用【维棠】下载视频">维棠下载</a><span id="vidown_float_panel_sep">|</span><input type="button" value=" " id="vidown_float_panel_close" title="关闭"></div></body></html>